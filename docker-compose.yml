version: '2'
services:
  solr: 
    image: solr:6.3.0
    ports:
      - "8983:8983"
    volumes:
      - data-solr-dev:/opt/solr/server/solr/mycores/
      - ./spotlight-demo/solr/config:/opt/solr/server/solr/configsets/data_driven_schema_configs
    entrypoint:
      - docker-entrypoint.sh
      - solr-precreate
      - mycore
    environment: 
      - VERBOSE=yes
  dev:
    build:
      dockerfile: Dockerfile-dev #this is just the path to the dockerfile
      context: .
    volumes:
      - ./spotlight-demo:/spotlight-demo #host's approotpath:containerpath
      - ./entrypoint.sh:/entrypoint.sh
    ports:
      - "3000:3000"
    links:
      - solr
    environment:
      - SOLR_URL=http://solr:8983/solr/mycore
      - OD_URL=http://oregondigital.org
    entrypoint: /entrypoint.sh
volumes:
  data-solr-dev: {}
